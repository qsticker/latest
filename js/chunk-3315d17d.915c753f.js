(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3315d17d"],{"339e":function(t,e,i){"use strict";var s=i("7e7e"),n=i.n(s);n.a},"498a":function(t,e,i){"use strict";var s=i("23e7"),n=i("58a8").trim,a=i("c8d2");s({target:"String",proto:!0,forced:a("trim")},{trim:function(){return n(this)}})},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var s=i("1d80"),n=i("5899"),a="["+n+"]",r=RegExp("^"+a+a+"*"),c=RegExp(a+a+"*$"),o=function(t){return function(e){var i=String(s(e));return 1&t&&(i=i.replace(r,"")),2&t&&(i=i.replace(c,"")),i}};t.exports={start:o(1),end:o(2),trim:o(3)}},"74c7":function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return a}));i("b0c0");var s,n=i("d4ec");(function(t){t["INIT"]="INIT",t["SCHEDULED"]="SCHEDULED",t["RUNNING"]="RUNNING",t["DONE"]="DONE",t["CANCELED"]="CANCELED",t["TERMINATED"]="TERMINATED",t["ERROR"]="ERROR"})(s||(s={}));var a=function t(e,i,s,a,r,c,o){if(Object(n["a"])(this,t),e&&(this.name=e),i&&(this.startTime=i),s&&(this.endTime=s),a&&(this.scheduledTime=a),r){this.quizGroupIdList=[];for(var l=0;l<r.length;l+=1)this.quizGroupIdList.push(r[l].uuid)}if(c){this.memberGroupIdList=[];for(var u=0;u<c.length;u+=1)this.memberGroupIdList.push(c[u].uuid)}null!==o&&(this.allowRetake=o)}},"7e7e":function(t,e,i){},8496:function(t,e,i){"use strict";i.r(e),i.d(e,"Visibility",(function(){return s}));var s,n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"workspace-browser-event"},[i("div",{staticClass:"top mx-4"},[t.currentFolder?i("Breadcrumb",{attrs:{situation:"workspaceBrower",path:t.currentFolder.path},on:{visitFolder:t.visitFolder}}):t._e(),i("div",{staticClass:"action-area p-4"},[t.selectModeOpen&&t.selection.length>0?i("div",{staticClass:"action-btns"},[i("div",{staticClass:"buttons"},[1===t.selection.length?i("b-button",{on:{click:function(e){return e.preventDefault(),t.shareCards(e)}}},[i("i",{staticClass:"fas fa-user-plus"})]):t._e(),1===t.selection.length&&"WorkspaceFolder"!==t.selection[0].metadata.type?i("b-button",{staticClass:"btn-info",on:{click:function(e){return e.preventDefault(),t.enterGroupPreview(e)}}},[i("i",{staticClass:"fas fa-eye"})]):t._e(),1===t.selection.length&&"WorkspaceFolder"!==t.selection[0].metadata.type?i("b-button",{staticClass:"btn-info",on:{click:function(e){return e.preventDefault(),t.enterGroup(e)}}},[i("i",{staticClass:"fas fa-pen"})]):t._e(),1===t.selection.length&&"WorkspaceFolder"===t.selection[0].metadata.type?i("b-button",{staticClass:"btn-info",on:{click:function(e){return e.preventDefault(),t.$modal.show("update-workspace-object-name-modal",{workspaceObject:t.selection[0]})}}},[i("i",{staticClass:"fas fa-pen"})]):t._e(),i("b-button",{on:{click:function(e){return e.preventDefault(),t.removeCards(e)}}},[i("i",{staticClass:"fas fa-trash-alt"})]),i("b-button",{staticClass:"btn-info",on:{click:function(e){return e.preventDefault(),t.moveCards(e)}}},[i("i",{staticClass:"fas fa-arrows-alt"})])],1)]):t._e(),i("div",{staticClass:"select-btn"},[i("button",{staticClass:"btn btn-secondary",on:{click:t.toggleSelectMode}},[t.selectModeOpen?i("span",[t._v(t._s(t.$t("取消")))]):t._e(),t.selectModeOpen?t._e():i("span",[t._v(t._s(t.$t("選取")))])])])])],1),i("div",{staticClass:"p-4"},[t.subfolders.length>0?i("div",{staticClass:"folder-area mb-5"},[i("h1",{staticClass:"m-3"},[t._v(" "+t._s(t.$t("資料夾"))+" ")]),i("FolderList",{attrs:{selection:t.selection,"select-mode-open":t.selectModeOpen},on:{toggle:t.toggleSelection}})],1):t._e(),t.workspaceObjects.length>0?i("div",{staticClass:"workspace-objects"},[i("div",{staticClass:"search-area"},[i("h1",{staticClass:"ml-3"},[t._v(" "+t._s(t.$t("檔案"))+" ")]),i("div",{staticClass:"input-group"},[t._m(0),i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchString,expression:"searchString"}],staticClass:"form-control",attrs:{id:"search",type:"text",placeholder:t.$t("請輸入測驗名稱")},domProps:{value:t.searchString},on:{input:function(e){e.target.composing||(t.searchString=e.target.value)}}}),t.searchString?i("div",{staticClass:"input-group-prepend"},[i("button",{staticClass:"input-group-text clear-btn",on:{click:function(e){t.searchString=""}}},[i("i",{staticClass:"fas fa-times"})])]):t._e(),""!==t.trimSearchString?i("div",{staticClass:"searchTip"},[t._v(" "+t._s(t.$t("搜尋"))+' "'+t._s(t.trimSearchString)+'"：'+t._s(t.$t("有n個結果",{n:t.searchList.length}))+" ")]):t._e()])]),i("div",{staticClass:"filter-area"},[i("ul",{staticClass:"nav nav-tabs"},[i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:t.visibility===t.Visibility.ALL},on:{click:function(e){e.preventDefault(),t.visibility=t.Visibility.ALL}}},[t._v(" "+t._s(t.$t("全部"))+" ("+t._s(t.workspaceObjects.length)+") ")])]),i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:t.visibility===t.Visibility.SENT},on:{click:function(e){e.preventDefault(),t.visibility=t.Visibility.SENT}}},[t._v(" "+t._s(t.$t("已發送"))+" ("+t._s(t.sentList.length)+") ")])]),i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:t.visibility===t.Visibility.SCHEDULED},on:{click:function(e){e.preventDefault(),t.visibility=t.Visibility.SCHEDULED}}},[t._v(" "+t._s(t.$t("排程發送"))+" ("+t._s(t.scheduledList.length)+") ")])]),i("li",{staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:t.visibility===t.Visibility.NOT_SCHEDULED},on:{click:function(e){e.preventDefault(),t.visibility=t.Visibility.NOT_SCHEDULED}}},[t._v(" "+t._s(t.$t("尚未安排"))+" ("+t._s(t.notScheduledList.length)+") ")])])])]),i("transition-group",{staticClass:"transition-tag",attrs:{name:"list-complete",tag:"div"}},t._l(t.filteredMethodList,(function(e){return i("div",{key:e.uuid,staticClass:"list-complete-item col-lg-4 col-xl-3 my-3 ui-card"},[i("div",{staticClass:"selectedItem"},[i("WorkspaceObjectItem",{attrs:{"workspace-object":e,"default-selected":!1,"allow-select-many":!0,"select-mode-open":t.selectModeOpen,selection:t.selection,"display-mode":"workspaceSelectFile"},on:{toggle:function(i){return t.toggleSelection(e)},removeMe:function(i){return t.removeGroupCard(e)}}})],1)])})),0)],1):t._e(),0===t.workspaceObjects.length&&0===t.subfolders.length?i("div",[i("EmptyHint")],1):t._e()]),i("MovePositionModal",{attrs:{current:t.currentFolder},on:{submit:t.moveCardsSubmit}}),i("UpdateWorkspaceObjectNameModal",{on:{submit:t.reload}}),i("v-dialog")],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"input-group-prepend"},[i("label",{staticClass:"input-group-text",attrs:{for:"search"}},[i("i",{staticClass:"fas fa-search"})])])}],r=(i("4de4"),i("c740"),i("4160"),i("c975"),i("a434"),i("b0c0"),i("d3b7"),i("3ca3"),i("498a"),i("159b"),i("ddb0"),i("96cf"),i("1da1")),c=i("2b0e"),o=i("d98b"),l=i("aa73"),u=i("0ccf"),d=i("f410"),f=i("18ad"),h=i("b26e"),p=i("010d"),m=i("8eb5"),v=i("dcc1"),b=i("add5"),g=i("74c7");(function(t){t[t["ALL"]=0]="ALL",t[t["SENT"]=1]="SENT",t[t["SCHEDULED"]=2]="SCHEDULED",t[t["NOT_SCHEDULED"]=3]="NOT_SCHEDULED"})(s||(s={}));var C=c["default"].extend({components:{EmptyHint:o["a"],FolderList:u["a"],Breadcrumb:p["a"],WorkspaceObjectItem:m["a"],MovePositionModal:v["a"],UpdateWorkspaceObjectNameModal:b["a"]},data:function(){return{selection:[],selectModeOpen:!1,searchString:"",Visibility:s,visibility:s.ALL}},computed:{currentFolder:function(){return this.$store.state.currentFolder},subfolders:function(){return this.currentFolder?this.currentFolder.children.filter((function(t){return t.metadata.type===f["a"].Folder})).sort((function(t,e){return t.metadata.name<e.metadata.name?-1:t.metadata.name>e.metadata.name?1:0})):[]},workspaceObjects:function(){return this.currentFolder?this.currentFolder.children.filter((function(t){return t.metadata.type!==f["a"].Folder})).sort((function(t,e){return t.metadata.name<e.metadata.name?-1:t.metadata.name>e.metadata.name?1:0})):[]},sentList:function(){var t=[];return this.workspaceObjects.forEach((function(e){if(e.metadata.type===f["a"].QuizEvent){var i=g["a"].ERROR,s=e;if(s.stateHistory){var n=s.stateHistory.length-1;i=s.stateHistory[n].state,i===g["a"].DONE&&t.push(s)}}})),t},scheduledList:function(){var t=[];return this.workspaceObjects.forEach((function(e){if(e.metadata.type===f["a"].QuizEvent){var i=g["a"].ERROR,s=e;if(s.stateHistory){var n=s.stateHistory.length-1;i=s.stateHistory[n].state,i===g["a"].SCHEDULED&&t.push(s)}}})),t},notScheduledList:function(){var t=[];return this.workspaceObjects.forEach((function(e){if(e.metadata.type===f["a"].QuizEvent){var i=g["a"].ERROR,s=e;if(s.stateHistory){var n=s.stateHistory.length-1;i=s.stateHistory[n].state,i===g["a"].CANCELED&&t.push(e)}else t.push(e)}})),t},trimSearchString:function(){var t=this.searchString.trim();return t},searchList:function(){var t=this,e=[];return this.visibleList.forEach((function(i){var s=i.metadata.name,n=t.trimSearchString,a=s.toUpperCase().indexOf(n.toUpperCase());a>=0&&e.push(i)})),e},visibleList:function(){switch(this.visibility){case s.ALL:return this.workspaceObjects;case s.SENT:return this.sentList;case s.SCHEDULED:return this.scheduledList;case s.NOT_SCHEDULED:return this.notScheduledList;default:return[]}},filteredMethodList:function(){return""!==this.trimSearchString?this.searchList:this.visibleList}},watch:{"$route.params.folderId":{handler:function(t){t&&(h["a"].loadFolder(t),this.selectInit())},immediate:!0}},mounted:function(){return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:l["a"].loginCheck();case 1:case"end":return t.stop()}}),t)})))()},methods:{reload:function(){this.currentFolder&&h["a"].loadFolder(this.currentFolder.uuid),this.selectInit()},selectInit:function(){this.selectModeOpen=!1,this.selection=[],this.searchString=""},toggleSelectMode:function(){this.selectModeOpen=!this.selectModeOpen,this.selectModeOpen||(this.selection=[])},toggleSelection:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:s=e.selection.findIndex((function(e){return e.uuid===t.uuid})),-1===s?e.selection.push(t):e.selection.splice(s,1);case 2:case"end":return i.stop()}}),i)})))()},moveCards:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$modal.show("move-position-modal",{currentFolder:t.currentFolder});case 1:case"end":return e.stop()}}),e)})))()},moveCardsSubmit:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){var s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return console.log(t),s=[],e.selection.forEach((function(i){e.currentFolder&&s.push(d["a"].move(i.uuid,t))})),i.next=5,Promise.all(s);case 5:e.visitFolder(t),e.$modal.hide("move-position-modal"),e.selectInit();case 8:case"end":return i.stop()}}),i)})))()},removeCards:function(){var t=this;this.$modal.show("dialog",{title:"確定刪除嗎?",text:"刪掉就不會再回來囉",buttons:[{title:"取消",handler:function(){t.$modal.hide("dialog")}},{title:"確定",handler:function(){t.$modal.hide("dialog"),t.removeManyGroups()}}]})},shareCards:function(){this.$modal.show("manage-share-mapping-modal",{sourceObjectId:this.selection[0].uuid}),this.selectInit()},enterGroupPreview:function(){var t=this.selection[0];"WorkspaceQuizEvent"===t.metadata.type&&(this.$store.commit("changeQuizEvent",t),this.$router.push("/manager/quizevent-preview"))},enterGroup:function(){var t=this.selection[0];"WorkspaceQuizEvent"===t.metadata.type&&(this.$store.commit("changeQuizEvent",t),this.$router.push("/manager/quizevent-maker"))},removeManyGroups:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=[],t.selection.forEach((function(e){i.push(t.removeGroupCard(e))})),e.next=4,Promise.all(i);case 4:t.selectInit();case 5:case"end":return e.stop()}}),e)})))()},removeGroupCard:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,d["a"].remove(t.uuid);case 2:e.currentFolder&&h["a"].loadFolder(e.currentFolder.uuid);case 3:case"end":return i.stop()}}),i)})))()},visitFolder:function(t){var e=this.$store.state.currentFolder.uuid;t!==e&&this.$router.push({params:{folderId:t}})}}}),E=C,w=(i("cce5"),i("339e"),i("2877")),k=Object(w["a"])(E,n,a,!1,null,"df63650a",null);e["default"]=k.exports},"91c8":function(t,e,i){},c8d2:function(t,e,i){var s=i("d039"),n=i("5899"),a="​᠎";t.exports=function(t){return s((function(){return!!n[t]()||a[t]()!=a||n[t].name!==t}))}},c975:function(t,e,i){"use strict";var s=i("23e7"),n=i("4d64").indexOf,a=i("a640"),r=i("ae40"),c=[].indexOf,o=!!c&&1/[1].indexOf(1,-0)<0,l=a("indexOf"),u=r("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:o||!l||!u},{indexOf:function(t){return o?c.apply(this,arguments)||0:n(this,t,arguments.length>1?arguments[1]:void 0)}})},cce5:function(t,e,i){"use strict";var s=i("91c8"),n=i.n(s);n.a}}]);
//# sourceMappingURL=chunk-3315d17d.915c753f.js.map